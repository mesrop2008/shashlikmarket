<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–æ—Ä–∑–∏–Ω–∞</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
  {% extends "layout.html" %}
  {% load static %}
  {% block content %}
  <div class="max-w-4xl mx-auto px-4 py-6 sm:py-12">
    <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-6 sm:mb-8 flex items-center gap-3">
      üõí –ö–æ—Ä–∑–∏–Ω–∞
    </h1>

    <div class="cart-content">
      {% if items %}
      <div class="space-y-4 sm:space-y-6">
        <!-- Cart Items -->
        <div class="bg-white rounded-lg shadow-md sm:shadow-lg overflow-hidden">
          <div class="p-4 sm:p-6 border-b border-gray-200">
            <h2 class="text-lg sm:text-xl font-semibold text-gray-900">–í–∞—à–∏ —Ç–æ–≤–∞—Ä—ã</h2>
          </div>
          
          <div class="p-4 sm:p-6 space-y-4" id="cart-items-container">
            {% for product in items %}
            <!-- –¢–æ–≤–∞—Ä -->
            <div class="cart-item flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-6 p-3 sm:p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow" 
                 data-product-id="{{ product.product.id }}" 
                 data-price="{{ product.price }}">
              
              <!-- –ö–∞—Ä—Ç–∏–Ω–∫–∞ —Ç–æ–≤–∞—Ä–∞ -->
              <img src="{{ product.imagepath }}?f_auto,q_auto,w_300,h_300,c_fill,g_auto" alt="{{ product.name }}" loading="lazy"
                   class="w-16 h-16 sm:w-20 sm:h-20 object-cover rounded-lg flex-shrink-0">

              <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ -->
              <div class="flex-1 min-w-0 w-full sm:w-auto">
                <h3 class="font-semibold text-gray-900 text-base sm:text-lg mb-1">{{ product.name }}</h3>
                <p class="text-gray-600 text-sm sm:text-base">{{ product.price }}‚ÇΩ –∑–∞ –ø–æ—Ä—Ü–∏—é</p>
              </div>

              <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º -->
              <div class="flex items-center gap-2 bg-gray-100 rounded-lg px-3 py-2">
                <a href="{% url 'remove_quantity' product.product.id %}" 
                   data-product-id="{{ product.product.id }}"
                   class="cart-remove-btn w-8 h-8 flex items-center justify-center bg-white rounded-full shadow-sm hover:bg-gray-50 transition-colors">
                  <span class="text-lg font-bold">-</span>
                </a>
                <span class="product-quantity w-12 text-center font-semibold text-gray-900">{{ product.quantity }}</span>
                <a href="{% url 'add_to_cart' product.product.id %}" 
                   data-product-id="{{ product.product.id }}"
                   class="cart-add-btn w-8 h-8 flex items-center justify-center bg-white rounded-full shadow-sm hover:bg-gray-50 transition-colors">
                  <span class="text-lg font-bold">+</span>
                </a>
              </div>

              <!-- –¶–µ–Ω–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ -->
              <div class="flex items-center gap-4 ml-auto">
                <p class="product-subtotal font-semibold text-lg text-gray-900 whitespace-nowrap">{{ product.subtotal }}‚ÇΩ</p>
                <a href="{% url 'remove_from_cart' product.product.id %}" 
                   data-product-id="{{ product.product.id }}"
                   data-product-name="{{ product.name }}"
                   class="cart-remove-item-btn text-red-500 hover:text-red-700 transition-colors p-2 rounded-full hover:bg-red-50 flex-shrink-0"
                   title="–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã">
                  üóëÔ∏è
                </a>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>

        <!-- –ò—Ç–æ–≥–æ –∏ –∫–Ω–æ–ø–∫–∞ –∑–∞–∫–∞–∑–∞ -->
        <div class="bg-white rounded-lg shadow-md sm:shadow-lg p-4 sm:p-6">
          <div class="flex items-center justify-between text-lg sm:text-xl font-bold mb-4 sm:mb-6 pb-3 sm:pb-4 border-b border-gray-200">
            <span class="text-gray-900">–ò—Ç–æ–≥–æ:</span>
            <span class="cart-total text-orange-600">{{ total }}‚ÇΩ</span>
          </div>

          <a href="{% url 'create_order' %}"
            class="w-full block text-center bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold px-4 py-3 sm:py-4 rounded-lg transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98] text-base sm:text-lg">
            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
          </a>
          
          <!-- –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏ -->
          <a href="{% url 'menu' %}"
            class="w-full block text-center border border-gray-300 text-gray-700 font-semibold px-4 py-2 sm:py-3 rounded-lg mt-3 hover:bg-gray-50 transition-colors text-sm sm:text-base">
            ‚Üê –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
          </a>
        </div>
      </div>
      {% else %}
      <!-- –ü—É—Å—Ç–∞—è –∫–æ—Ä–∑–∏–Ω–∞ -->
      <div class="empty-cart text-center py-12 sm:py-16">
        <div class="text-6xl sm:text-8xl mb-4 sm:mb-6">üõí</div>
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-3 sm:mb-4">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h1>
        <p class="text-lg sm:text-xl text-gray-600 mb-6 sm:mb-8 max-w-md mx-auto px-4">
          –î–æ–±–∞–≤—å—Ç–µ –≤–∫—É—Å–Ω—ã–µ —à–∞—à–ª—ã–∫–∏ –∏–∑ –Ω–∞—à–µ–≥–æ –º–µ–Ω—é
        </p>
        <a href="{% url 'menu' %}"
          class="inline-block bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold px-6 py-3 sm:px-8 sm:py-4 rounded-lg transition-all duration-300 text-base sm:text-lg">
          –ü–µ—Ä–µ–π—Ç–∏ –∫ –º–µ–Ω—é
        </a>
      </div>
      {% endif %}
    </div>
  </div>

  <style>
    /* –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è */
    @media (max-width: 640px) {
      .cart-item {
        display: grid;
        grid-template-areas: 
          "image info"
          "controls price";
        grid-template-columns: auto 1fr;
        gap: 12px;
        align-items: start;
      }
      
      .cart-item img {
        grid-area: image;
      }
      
      .cart-item > div:first-of-type {
        grid-area: info;
      }
      
      .cart-item > div:nth-of-type(2) {
        grid-area: controls;
        justify-self: start;
      }
      
      .cart-item > div:last-of-type {
        grid-area: price;
        justify-self: end;
        align-self: center;
      }
    }
  </style>
  {% endblock %}
</body>

</html>